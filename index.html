<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Driving School Sim - Mobile App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Kanit', sans-serif; background-color: #f3f4f6; -webkit-tap-highlight-color: transparent; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 0px; background: transparent; }
        
        /* Disable text selection and ensure touch action is immediate */
        .pedal, .gear-btn, .sim-btn { 
            cursor: pointer; 
            touch-action: none; 
            -webkit-user-select: none; 
            user-select: none; 
            -webkit-touch-callout: none;
        }

        .pedal { transition: transform 0.1s, filter 0.2s; }
        .pedal:active, .pedal.pressed { transform: translateY(8px) scale(0.95); filter: brightness(1.2); }
        .pedal.locked { filter: brightness(1.2) sepia(1) hue-rotate(-50deg) saturate(3); transform: translateY(8px); border-color: #f59e0b; }

        .gear-btn { transition: all 0.2s; }
        .gear-btn.active { background-color: #2563eb; color: white; transform: scale(1.1); box-shadow: 0 4px 12px rgba(37, 99, 235, 0.4); }

        .needle { transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1); transform-origin: bottom center; }
        
        .nav-item.active { color: #2563eb; }
        .nav-item.active i { transform: translateY(-2px); }
        
        .sub-tab { transition: all 0.3s; border-bottom: 2px solid transparent; opacity: 0.6; }
        .sub-tab.active { border-color: #2563eb; color: #2563eb; opacity: 1; font-weight: 600; }

        .fade-in { animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        .no-select { user-select: none; -webkit-user-select: none; }
        .external-card:active { transform: scale(0.98); }

        /* Custom Modal Animation */
        #custom-modal.flex { animation: popIn 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes popIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
    </style>
</head>
<body class="bg-gray-100 h-screen flex flex-col overflow-hidden text-gray-800" oncontextmenu="return false;">

    <!-- Top Header -->
    <header class="bg-white shadow-sm px-4 py-3 flex justify-between items-center z-20 shrink-0">
        <div class="flex items-center gap-2">
            <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center text-white">
                <i class="fas fa-car-side"></i>
            </div>
            <h1 class="font-bold text-lg text-gray-800 tracking-tight">Driving Sim</h1>
        </div>
        <a href="https://www.dlt.go.th/" target="_blank" class="text-blue-600 text-xs font-semibold bg-blue-50 px-3 py-1 rounded-full">
            DLT ‡πÄ‡∏ß‡πá‡∏ö‡∏Å‡∏£‡∏°‡∏Ç‡∏ô‡∏™‡πà‡∏á‡∏Ø
        </a>
    </header>

    <!-- Main Content Area -->
    <main class="flex-1 overflow-y-auto relative bg-gray-50 pb-20" id="main-container">
        
        <!-- SECTION 1: KNOWLEDGE (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ) -->
        <div id="section-knowledge" class="fade-in min-h-full">
            <div class="sticky top-0 bg-white shadow-sm z-10 px-4 pt-2 overflow-x-auto whitespace-nowrap no-scrollbar">
                <div class="flex gap-6 pb-2">
                    <button onclick="switchSubTab('knowledge', 'license')" id="tab-license" class="sub-tab active pb-2">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÉ‡∏ö‡∏Ç‡∏±‡∏ö‡∏Ç‡∏µ‡πà</button>
                    <button onclick="switchSubTab('knowledge', 'manual-info')" id="tab-manual-info" class="sub-tab pb-2">‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤</button>
                    <button onclick="switchSubTab('knowledge', 'auto-info')" id="tab-auto-info" class="sub-tab pb-2">‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡∏≠‡∏≠‡πÇ‡∏ï‡πâ</button>
                    <button onclick="switchSubTab('knowledge', 'moto-info')" id="tab-moto-info" class="sub-tab pb-2">‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÑ‡∏ã‡∏Ñ‡πå</button>
                    <button onclick="switchSubTab('knowledge', 'bike-info')" id="tab-bike-info" class="sub-tab pb-2">‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô</button>
                </div>
            </div>

            <div class="p-4 space-y-4">
                
                <!-- 1. License Content -->
                <div id="content-license" class="knowledge-content">
                    <div class="bg-gradient-to-r from-blue-600 to-blue-800 rounded-2xl p-6 text-white shadow-lg mb-6">
                        <h2 class="text-2xl font-bold mb-2">‡∏ó‡∏≥‡πÉ‡∏ö‡∏Ç‡∏±‡∏ö‡∏Ç‡∏µ‡πà‡πÑ‡∏°‡πà‡∏¢‡∏≤‡∏Å!</h2>
                        <p class="opacity-90 text-sm">‡∏£‡∏ß‡∏°‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏à‡∏ô‡∏ñ‡∏∂‡∏á‡∏™‡∏≠‡∏ö‡∏ú‡πà‡∏≤‡∏ô</p>
                    </div>

                    <div class="grid gap-4 md:grid-cols-2">
                        <div class="bg-white p-5 rounded-xl shadow-sm border border-gray-100">
                            <div class="flex items-center gap-3 mb-3 text-blue-600 font-bold">
                                <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center">1</div>
                                <span>‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</span>
                            </div>
                            <ul class="text-sm text-gray-600 space-y-2 ml-11 list-disc">
                                <li>‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏ï‡∏±‡∏ß‡∏à‡∏£‡∏¥‡∏á</li>
                                <li>‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡πÅ‡∏û‡∏ó‡∏¢‡πå (‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 1 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)</li>
                            </ul>
                        </div>

                        <div class="bg-white p-5 rounded-xl shadow-sm border border-gray-100">
                            <div class="flex items-center gap-3 mb-3 text-purple-600 font-bold">
                                <div class="w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center">2</div>
                                <span>‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡∏°‡∏£‡∏£‡∏ñ‡∏†‡∏≤‡∏û</span>
                            </div>
                            <div class="grid grid-cols-2 gap-2 text-xs text-gray-500 ml-11">
                                <div class="bg-gray-50 p-2 rounded text-center">‡∏ï‡∏≤‡∏ö‡∏≠‡∏î‡∏™‡∏µ</div>
                                <div class="bg-gray-50 p-2 rounded text-center">‡∏™‡∏≤‡∏¢‡∏ï‡∏≤‡∏ó‡∏≤‡∏á‡∏•‡∏∂‡∏Å</div>
                                <div class="bg-gray-50 p-2 rounded text-center">‡∏™‡∏≤‡∏¢‡∏ï‡∏≤‡∏ó‡∏≤‡∏á‡∏Å‡∏ß‡πâ‡∏≤‡∏á</div>
                                <div class="bg-gray-50 p-2 rounded text-center">‡∏õ‡∏è‡∏¥‡∏Å‡∏¥‡∏£‡∏¥‡∏¢‡∏≤‡πÄ‡∏ó‡πâ‡∏≤</div>
                            </div>
                        </div>

                        <div class="bg-white p-5 rounded-xl shadow-sm border border-gray-100 md:col-span-2">
                             <div class="flex items-center gap-3 mb-3 text-orange-600 font-bold">
                                <div class="w-8 h-8 rounded-full bg-orange-100 flex items-center justify-center">3</div>
                                <span>‡∏™‡∏≠‡∏ö‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥ (‡∏£‡∏ñ‡∏¢‡∏ô‡∏ï‡πå)</span>
                            </div>
                            <div class="flex gap-4 overflow-x-auto pb-2">
                                <div class="min-w-[140px] bg-gray-50 p-3 rounded-lg text-center border border-gray-200">
                                    <i class="fas fa-arrows-alt-v text-2xl text-gray-400 mb-2"></i>
                                    <div class="font-bold text-sm">‡πÄ‡∏î‡∏¥‡∏ô‡∏´‡∏ô‡πâ‡∏≤-‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á</div>
                                    <div class="text-[10px] text-gray-400">‡∏´‡πâ‡∏≤‡∏°‡∏ä‡∏ô‡∏´‡∏•‡∏±‡∏Å</div>
                                </div>
                                <div class="min-w-[140px] bg-gray-50 p-3 rounded-lg text-center border border-gray-200">
                                    <i class="fas fa-parking text-2xl text-gray-400 mb-2"></i>
                                    <div class="font-bold text-sm">‡∏à‡∏≠‡∏î‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡πâ‡∏≤</div>
                                    <div class="text-[10px] text-gray-400">‡∏´‡πà‡∏≤‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 25cm</div>
                                </div>
                                <div class="min-w-[140px] bg-gray-50 p-3 rounded-lg text-center border border-gray-200">
                                    <i class="fas fa-reply text-2xl text-gray-400 mb-2"></i>
                                    <div class="font-bold text-sm">‡∏ñ‡∏≠‡∏¢‡πÄ‡∏Ç‡πâ‡∏≤‡∏ã‡∏≠‡∏á</div>
                                    <div class="text-[10px] text-gray-400">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå < 7 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 2. Manual Info -->
                <div id="content-manual-info" class="knowledge-content hidden">
                    <div class="bg-blue-600 rounded-2xl p-6 text-white shadow-lg mb-6">
                        <i class="fas fa-cogs text-4xl mb-2 opacity-80"></i>
                        <h2 class="text-2xl font-bold mb-1">‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤</h2>
                        <p class="opacity-90 text-sm">‡∏Ç‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏Å ‡∏Ñ‡∏∏‡∏°‡∏£‡∏ñ‡πÑ‡∏î‡πâ‡∏î‡∏±‡πà‡∏á‡πÉ‡∏à</p>
                    </div>

                    <div class="bg-white p-6 rounded-xl shadow-sm mb-4">
                        <h3 class="font-bold text-lg mb-4 text-blue-800 border-b pb-2">‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: "‡∏Ñ‡∏•‡∏±‡∏ï‡∏ä‡πå" (Clutch)</h3>
                        <div class="flex gap-4 items-center mb-4">
                            <div class="w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center text-2xl">ü¶µ</div>
                            <div class="text-sm text-gray-600">
                                <p><b>‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏´‡∏£‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏ö?</b> ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó‡∏£‡∏ñ, ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå, ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏∞‡∏à‡∏≠‡∏î‡∏™‡∏ô‡∏¥‡∏ó</p>
                                <p class="mt-1"><b>‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏´‡∏£‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏•‡πà‡∏≠‡∏¢?</b> ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏£‡∏ñ‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà (‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏ä‡πâ‡∏≤‡πÜ) ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß</p>
                            </div>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-lg text-sm text-blue-800">
                            <i class="fas fa-lightbulb text-yellow-500 mr-2"></i> <b>‡∏ó‡∏£‡∏¥‡∏Ñ:</b> ‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡πÉ‡∏´‡πâ‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏Ñ‡∏•‡∏±‡∏ï‡∏ä‡πå‡∏ä‡πâ‡∏≤‡πÜ ‡∏à‡∏ô‡∏ñ‡∏∂‡∏á‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏£‡∏ñ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏±‡πà‡∏ô (Biting Point) ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡πÄ‡∏ï‡∏¥‡∏°‡∏Ñ‡∏±‡∏ô‡πÄ‡∏£‡πà‡∏á ‡∏£‡∏ñ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏î‡∏±‡∏ö
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-xl shadow-sm">
                        <h3 class="font-bold text-lg mb-4 text-blue-800 border-b pb-2">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="text-center p-3 border rounded-lg">
                                <div class="font-bold text-xl text-gray-700">1 - 2</div>
                                <div class="text-xs text-gray-500">‡∏≠‡∏≠‡∏Å‡∏ï‡∏±‡∏ß / ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏ä‡∏±‡∏ô / ‡∏£‡∏ñ‡∏ï‡∏¥‡∏î</div>
                            </div>
                            <div class="text-center p-3 border rounded-lg">
                                <div class="font-bold text-xl text-gray-700">3 - 4</div>
                                <div class="text-xs text-gray-500">‡∏Ç‡∏±‡∏ö‡∏Ç‡∏µ‡πà‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡πÉ‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á</div>
                            </div>
                            <div class="text-center p-3 border rounded-lg">
                                <div class="font-bold text-xl text-gray-700">5</div>
                                <div class="text-xs text-gray-500">‡∏ó‡∏≤‡∏á‡πÑ‡∏Å‡∏• / ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏™‡∏π‡∏á</div>
                            </div>
                             <div class="text-center p-3 border rounded-lg bg-red-50 border-red-100">
                                <div class="font-bold text-xl text-red-600">R</div>
                                <div class="text-xs text-red-400">‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á (‡∏à‡∏≠‡∏î‡∏™‡∏ô‡∏¥‡∏ó‡∏Å‡πà‡∏≠‡∏ô)</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 3. Auto Info -->
                <div id="content-auto-info" class="knowledge-content hidden">
                    <div class="bg-green-600 rounded-2xl p-6 text-white shadow-lg mb-6">
                        <i class="fas fa-magic text-4xl mb-2 opacity-80"></i>
                        <h2 class="text-2xl font-bold mb-1">‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡∏≠‡∏≠‡πÇ‡∏ï‡πâ</h2>
                        <p class="opacity-90 text-sm">‡∏Ç‡∏±‡∏ö‡∏á‡πà‡∏≤‡∏¢ ‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡∏™‡∏ö‡∏≤‡∏¢</p>
                    </div>

                    <div class="bg-white p-6 rounded-xl shadow-sm mb-4">
                        <h3 class="font-bold text-lg mb-4 text-green-800 border-b pb-2">‡∏£‡∏´‡∏±‡∏™‡∏•‡∏±‡∏ö P-R-N-D</h3>
                        <div class="space-y-3">
                            <div class="flex items-center gap-4">
                                <div class="w-10 h-10 bg-gray-800 text-white rounded font-bold flex items-center justify-center">P</div>
                                <div>
                                    <div class="font-bold text-sm">Park (‡∏à‡∏≠‡∏î)</div>
                                    <div class="text-xs text-gray-500">‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏à‡∏≠‡∏î‡∏£‡∏ñ‡∏™‡∏ô‡∏¥‡∏ó‡πÅ‡∏•‡∏∞‡∏à‡∏∞‡∏•‡∏á‡∏à‡∏≤‡∏Å‡∏£‡∏ñ ‡∏£‡∏ñ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏•‡πá‡∏≠‡∏Ñ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÑ‡∏´‡∏•</div>
                                </div>
                            </div>
                            <div class="flex items-center gap-4">
                                <div class="w-10 h-10 bg-gray-800 text-white rounded font-bold flex items-center justify-center">R</div>
                                <div>
                                    <div class="font-bold text-sm">Reverse (‡∏ñ‡∏≠‡∏¢)</div>
                                    <div class="text-xs text-gray-500">‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á *‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏ö‡πÄ‡∏ö‡∏£‡∏Å‡πÉ‡∏´‡πâ‡∏™‡∏ô‡∏¥‡∏ó‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡∏ô‡∏µ‡πâ</div>
                                </div>
                            </div>
                            <div class="flex items-center gap-4">
                                <div class="w-10 h-10 bg-gray-800 text-white rounded font-bold flex items-center justify-center">N</div>
                                <div>
                                    <div class="font-bold text-sm">Neutral (‡∏ß‡πà‡∏≤‡∏á)</div>
                                    <div class="text-xs text-gray-500">‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡∏ß‡πà‡∏≤‡∏á ‡πÄ‡∏Ç‡πá‡∏ô‡∏£‡∏ñ‡πÑ‡∏î‡πâ ‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏à‡∏≠‡∏î‡∏ï‡∏¥‡∏î‡πÑ‡∏ü‡πÅ‡∏î‡∏á‡∏ô‡∏≤‡∏ô‡πÜ ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏≠‡∏î‡∏ã‡πâ‡∏≠‡∏ô‡∏Ñ‡∏±‡∏ô</div>
                                </div>
                            </div>
                            <div class="flex items-center gap-4">
                                <div class="w-10 h-10 bg-gray-800 text-white rounded font-bold flex items-center justify-center">D</div>
                                <div>
                                    <div class="font-bold text-sm">Drive (‡∏Ç‡∏±‡∏ö)</div>
                                    <div class="text-xs text-gray-500">‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡πÄ‡∏î‡∏¥‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥ ‡∏£‡∏ñ‡∏à‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-red-50 border border-red-100 p-5 rounded-xl">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-exclamation-circle text-red-500 text-xl mt-1"></i>
                            <div>
                                <h4 class="font-bold text-red-800 text-sm">‡∏Å‡∏é‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡∏≠‡∏≠‡πÇ‡∏ï‡πâ</h4>
                                <p class="text-xs text-red-700 mt-1">"‡πÄ‡∏ó‡πâ‡∏≤‡∏Ç‡∏ß‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô!" ‡πÉ‡∏ä‡πâ‡πÄ‡∏ó‡πâ‡∏≤‡∏Ç‡∏ß‡∏≤‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏±‡∏ô‡πÄ‡∏£‡πà‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏ö‡∏£‡∏Å ‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ‡πÄ‡∏ó‡πâ‡∏≤‡∏ã‡πâ‡∏≤‡∏¢‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏ö‡πÄ‡∏ö‡∏£‡∏Å‡πÄ‡∏î‡πá‡∏î‡∏Ç‡∏≤‡∏î ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏ö‡∏™‡∏ô‡∏¢‡∏≤‡∏°‡∏ï‡∏Å‡πÉ‡∏à</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                 <!-- 4. Moto Info -->
                 <div id="content-moto-info" class="knowledge-content hidden">
                     <div class="bg-orange-500 rounded-2xl p-6 text-white shadow-lg mb-6 relative overflow-hidden">
                        <i class="fas fa-motorcycle absolute -right-4 -bottom-4 text-8xl opacity-20"></i>
                        <h2 class="text-2xl font-bold mb-2">‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Ç‡∏µ‡πà‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÑ‡∏ã‡∏Ñ‡πå</h2>
                        <p class="opacity-90 text-sm">‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</p>
                    </div>

                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden mb-4">
                        <div class="bg-gray-50 px-4 py-3 border-b border-gray-100 font-bold text-gray-700">
                            <i class="fas fa-check-circle text-green-500 mr-2"></i> ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó
                        </div>
                        <div class="p-4 grid grid-cols-2 gap-4">
                            <div class="text-center">
                                <i class="fas fa-helmet-safety text-3xl text-gray-400 mb-2"></i>
                                <p class="text-xs font-bold">‡∏™‡∏ß‡∏°‡∏´‡∏°‡∏ß‡∏Å‡∏Å‡∏±‡∏ô‡∏ô‡πá‡∏≠‡∏Ñ</p>
                                <p class="text-[10px] text-gray-400">‡∏•‡πá‡∏≠‡∏Ñ‡∏™‡∏≤‡∏¢‡∏£‡∏±‡∏î‡∏Ñ‡∏≤‡∏á‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡∏ô</p>
                            </div>
                            <div class="text-center">
                                <i class="fas fa-tshirt text-3xl text-gray-400 mb-2"></i>
                                <p class="text-xs font-bold">‡πÅ‡∏ï‡πà‡∏á‡∏Å‡∏≤‡∏¢‡∏£‡∏±‡∏î‡∏Å‡∏∏‡∏°</p>
                                <p class="text-[10px] text-gray-400">‡∏Å‡∏≤‡∏á‡πÄ‡∏Å‡∏á‡∏Ç‡∏≤‡∏¢‡∏≤‡∏ß ‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏´‡∏∏‡πâ‡∏°‡∏™‡πâ‡∏ô</p>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-3">
                         <div class="flex items-start gap-4 bg-white p-4 rounded-xl shadow-sm">
                            <div class="w-10 h-10 rounded-full bg-orange-100 flex items-center justify-center shrink-0 text-orange-600 font-bold">1</div>
                            <div>
                                <h4 class="font-bold text-gray-800">‡∏Å‡∏≤‡∏£‡∏ó‡∏£‡∏á‡∏ï‡∏±‡∏ß</h4>
                                <p class="text-sm text-gray-600 mt-1">‡∏ï‡∏≤‡∏°‡∏≠‡∏á‡πÑ‡∏õ‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏°‡∏≠ ‡∏≠‡∏¢‡πà‡∏≤‡∏°‡∏≠‡∏á‡∏•‡πâ‡∏≠‡∏´‡∏ô‡πâ‡∏≤ ‡∏´‡∏ô‡∏µ‡∏ö‡∏ñ‡∏±‡∏á‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏Ç‡πà‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏£‡∏ñ‡∏ô‡∏¥‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô</p>
                            </div>
                        </div>
                        <div class="flex items-start gap-4 bg-white p-4 rounded-xl shadow-sm">
                            <div class="w-10 h-10 rounded-full bg-orange-100 flex items-center justify-center shrink-0 text-orange-600 font-bold">2</div>
                            <div>
                                <h4 class="font-bold text-gray-800">‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÄ‡∏ö‡∏£‡∏Å</h4>
                                <p class="text-sm text-gray-600 mt-1">‡πÉ‡∏ä‡πâ‡πÄ‡∏ö‡∏£‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏´‡∏•‡∏±‡∏á‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô‡πÄ‡∏™‡∏°‡∏≠ ‡∏´‡πâ‡∏≤‡∏°‡∏Å‡∏≥‡πÄ‡∏ö‡∏£‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏∞‡∏ó‡∏±‡∏ô‡∏´‡∏±‡∏ô‡∏Ç‡∏ì‡∏∞‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏ß ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏£‡∏ñ‡∏à‡∏∞‡∏û‡∏±‡∏ö‡∏•‡πâ‡∏°‡πÑ‡∏î‡πâ</p>
                            </div>
                        </div>
                         <div class="flex items-start gap-4 bg-white p-4 rounded-xl shadow-sm">
                            <div class="w-10 h-10 rounded-full bg-orange-100 flex items-center justify-center shrink-0 text-orange-600 font-bold">3</div>
                            <div>
                                <h4 class="font-bold text-gray-800">‡∏à‡∏∏‡∏î‡∏ö‡∏≠‡∏î</h4>
                                <p class="text-sm text-gray-600 mt-1">‡∏≠‡∏¢‡πà‡∏≤‡∏Ç‡∏µ‡πà‡∏ï‡∏µ‡∏Ñ‡∏π‡πà‡∏£‡∏ñ‡πÉ‡∏´‡∏ç‡πà ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏à‡∏∏‡∏î‡∏ö‡∏≠‡∏î‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏∞‡∏à‡∏Å‡∏°‡∏≠‡∏á‡∏Ç‡πâ‡∏≤‡∏á‡∏£‡∏ñ‡∏¢‡∏ô‡∏ï‡πå‡∏°‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô</p>
                            </div>
                        </div>
                    </div>
                </div>

                 <!-- 5. Bike Info -->
                 <div id="content-bike-info" class="knowledge-content hidden">
                    <div class="bg-green-600 rounded-2xl p-6 text-white shadow-lg mb-6">
                        <h2 class="text-2xl font-bold mb-2">‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</h2>
                        <p class="opacity-90 text-sm">‡∏Å‡∏é‡∏à‡∏£‡∏≤‡∏à‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡∏õ‡∏±‡πà‡∏ô</p>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm text-center">
                        <i class="fas fa-bicycle text-6xl text-green-500 mb-4"></i>
                        <p class="text-gray-700 font-bold text-lg">"‡∏ä‡∏¥‡∏î‡∏ã‡πâ‡∏≤‡∏¢ ‡πÄ‡∏™‡∏°‡∏≠"</p>
                        <p class="text-gray-500 text-sm mt-2">‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏ñ‡∏ä‡πâ‡∏≤ ‡∏Ñ‡∏ß‡∏£‡∏Ç‡∏±‡∏ö‡∏Ç‡∏µ‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢‡∏™‡∏∏‡∏î ‡∏´‡∏£‡∏∑‡∏≠ Bike Lane ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡∏´‡πâ‡∏≤‡∏°‡∏Ç‡∏µ‡πà‡∏™‡∏ß‡∏ô‡πÄ‡∏•‡∏ô‡πÄ‡∏î‡πá‡∏î‡∏Ç‡∏≤‡∏î</p>
                        <hr class="my-4 border-gray-100">
                        <div class="text-left space-y-3">
                            <p class="text-sm"><i class="fas fa-hand-paper w-6 text-center text-green-600"></i> <b>‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏ß‡∏ã‡πâ‡∏≤‡∏¢:</b> ‡∏¢‡∏∑‡πà‡∏ô‡πÅ‡∏Ç‡∏ô‡∏ã‡πâ‡∏≤‡∏¢‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ‡πÄ‡∏™‡∏°‡∏≠‡πÑ‡∏´‡∏•‡πà</p>
                            <p class="text-sm"><i class="fas fa-hand-paper w-6 text-center text-green-600"></i> <b>‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏ß‡∏Ç‡∏ß‡∏≤:</b> ‡∏¢‡∏∑‡πà‡∏ô‡πÅ‡∏Ç‡∏ô‡∏Ç‡∏ß‡∏≤‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ‡πÄ‡∏™‡∏°‡∏≠‡πÑ‡∏´‡∏•‡πà</p>
                            <p class="text-sm"><i class="fas fa-hand-paper w-6 text-center text-green-600"></i> <b>‡∏´‡∏¢‡∏∏‡∏î‡∏£‡∏ñ:</b> ‡∏¢‡∏Å‡πÅ‡∏Ç‡∏ô‡∏Ç‡∏ß‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏â‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SECTION 2: SIMULATOR (‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏î‡∏•‡∏≠‡∏á) - UPDATED FOR MULTI-TOUCH -->
        <div id="section-sim" class="fade-in min-h-full hidden">
             <div class="sticky top-0 bg-white shadow-sm z-10 px-4 pt-2">
                <div class="flex gap-6 pb-2 justify-center">
                    <button onclick="switchSubTab('sim', 'manual')" id="tab-manual" class="sub-tab active pb-2">‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤</button>
                    <button onclick="switchSubTab('sim', 'auto')" id="tab-auto" class="sub-tab pb-2">‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡∏≠‡∏≠‡πÇ‡∏ï‡πâ</button>
                </div>
            </div>

            <div class="p-2 md:p-4 h-full">
                <!-- MANUAL SIMULATOR -->
                <div id="content-manual" class="sim-content h-full flex flex-col items-center">
                    <div class="w-full max-w-lg bg-white rounded-xl shadow-sm p-3 mb-4 flex gap-3 border-l-4 border-blue-500 relative">
                        <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Instructor" class="w-10 h-10 rounded-full bg-blue-50">
                        <div class="flex-1">
                            <p class="text-xs font-bold text-blue-900 mb-1">‡∏Ñ‡∏£‡∏π‡∏ù‡∏∂‡∏Å‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤</p>
                            <p id="manual-instruction" class="text-sm text-gray-700 leading-tight">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡∏ß‡πà‡∏≤‡∏á (N) ‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏ö <b>‡∏Ñ‡∏•‡∏±‡∏ï‡∏ä‡πå</b> ‡∏Ñ‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó</p>
                            <div class="flex gap-2 mt-2 justify-end">
                                <button onclick="manualTutorial.prev()" class="px-3 py-1 bg-gray-100 rounded text-xs hover:bg-gray-200">‡∏¢‡πâ‡∏≠‡∏ô</button>
                                <button onclick="manualTutorial.next()" class="px-3 py-1 bg-blue-600 text-white rounded text-xs hover:bg-blue-700 shadow-sm">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
                            </div>
                        </div>
                    </div>

                    <div class="w-full max-w-lg flex-1 bg-gray-800 rounded-2xl p-4 relative flex flex-col items-center justify-between min-h-[400px] border-4 border-gray-700 shadow-inner">
                        <div class="flex gap-4 mb-4 transform scale-90">
                            <div class="relative w-24 h-24 bg-black rounded-full border-2 border-gray-600 flex items-center justify-center">
                                <div class="absolute w-1 h-10 bg-red-500 bottom-1/2 left-1/2 -ml-0.5 origin-bottom needle" id="manual-speed-needle" style="transform: rotate(-120deg)"></div>
                                <span class="absolute bottom-6 text-white font-bold text-lg" id="manual-speed-text">0</span>
                                <span class="absolute bottom-2 text-gray-500 text-[10px]">km/h</span>
                            </div>
                            <div class="relative w-24 h-24 bg-black rounded-full border-2 border-gray-600 flex items-center justify-center">
                                <div class="absolute w-1 h-10 bg-yellow-400 bottom-1/2 left-1/2 -ml-0.5 origin-bottom needle" id="manual-rpm-needle" style="transform: rotate(-120deg)"></div>
                                <span class="absolute bottom-6 text-white font-bold text-lg" id="manual-rpm-text">0</span>
                                <span class="absolute bottom-2 text-gray-500 text-[10px]">x1000</span>
                            </div>
                        </div>
                        
                        <!-- Fixed Start Button for Multi-touch -->
                        <button 
                            ontouchstart="event.preventDefault(); toggleManualEngine()" 
                            onclick="toggleManualEngine()"
                            class="sim-btn absolute top-4 right-4 w-12 h-12 rounded-full bg-red-600 border-2 border-red-800 shadow text-white font-bold text-[10px] flex flex-col items-center justify-center active:scale-95 transition">
                            <i class="fas fa-power-off mb-0.5"></i> <span id="manual-status-text">START</span>
                        </button>

                        <!-- Gearbox with Multi-touch support and Spacing (mb-12) -->
                        <div class="bg-gray-200 p-2 rounded-full w-40 h-40 flex items-center justify-center shadow-lg relative mt-2 mb-12">
                             <div class="grid grid-cols-3 gap-2 relative z-10">
                                <!-- Added ontouchstart to all gears -->
                                <button ontouchstart="event.preventDefault(); shiftManual(1)" onclick="shiftManual(1)" id="gear-1" class="gear-btn w-9 h-9 rounded-full bg-gray-300 font-bold text-gray-600 text-sm">1</button>
                                <button ontouchstart="event.preventDefault(); shiftManual(3)" onclick="shiftManual(3)" id="gear-3" class="gear-btn w-9 h-9 rounded-full bg-gray-300 font-bold text-gray-600 text-sm">3</button>
                                <button ontouchstart="event.preventDefault(); shiftManual(5)" onclick="shiftManual(5)" id="gear-5" class="gear-btn w-9 h-9 rounded-full bg-gray-300 font-bold text-gray-600 text-sm">5</button>
                                <button ontouchstart="event.preventDefault(); shiftManual(2)" onclick="shiftManual(2)" id="gear-2" class="gear-btn w-9 h-9 rounded-full bg-gray-300 font-bold text-gray-600 text-sm">2</button>
                                <button ontouchstart="event.preventDefault(); shiftManual(4)" onclick="shiftManual(4)" id="gear-4" class="gear-btn w-9 h-9 rounded-full bg-gray-300 font-bold text-gray-600 text-sm">4</button>
                                <button ontouchstart="event.preventDefault(); shiftManual('R')" onclick="shiftManual('R')" id="gear-R" class="gear-btn w-9 h-9 rounded-full bg-red-100 text-red-600 font-bold text-sm">R</button>
                            </div>
                             <div class="absolute -bottom-6 bg-gray-900 text-white px-2 py-0.5 rounded text-xs font-mono">Gear: <span id="manual-gear-display" class="text-yellow-400">N</span></div>
                        </div>

                        <!-- Pedals -->
                        <div class="flex gap-2 w-full justify-center mt-auto no-select">
                            <div class="flex flex-col items-center">
                                <div id="pedal-clutch" 
                                     ontouchstart="event.preventDefault(); pressClutch(true)" ontouchend="event.preventDefault(); pressClutch(false)"
                                     onmousedown="pressClutch(true)" onmouseup="pressClutch(false)"
                                     class="pedal w-16 h-24 bg-gradient-to-b from-gray-600 to-gray-800 rounded-lg border-b-4 border-gray-900 shadow-lg relative">
                                </div>
                                <span class="text-gray-400 text-xs mt-1">‡∏Ñ‡∏•‡∏±‡∏ï‡∏ä‡πå</span>
                            </div>
                            <div class="flex flex-col items-center">
                                <div id="pedal-brake" 
                                     ontouchstart="event.preventDefault(); pressBrake(true)" ontouchend="event.preventDefault(); pressBrake(false)"
                                     onmousedown="pressBrake(true)" onmouseup="pressBrake(false)"
                                     class="pedal w-14 h-20 bg-gradient-to-b from-gray-600 to-gray-800 rounded-lg border-b-4 border-gray-900 shadow-lg relative mx-2">
                                </div>
                                <span class="text-gray-400 text-xs mt-1">‡πÄ‡∏ö‡∏£‡∏Å</span>
                            </div>
                            <div class="flex flex-col items-center">
                                <div id="pedal-gas" 
                                     ontouchstart="event.preventDefault(); pressGas(true)" ontouchend="event.preventDefault(); pressGas(false)"
                                     onmousedown="pressGas(true)" onmouseup="pressGas(false)"
                                     class="pedal w-10 h-24 bg-gradient-to-b from-gray-700 to-black rounded-lg border-b-4 border-gray-900 shadow-lg relative">
                                </div>
                                <span class="text-gray-400 text-xs mt-1">‡∏Ñ‡∏±‡∏ô‡πÄ‡∏£‡πà‡∏á</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AUTO SIMULATOR -->
                <div id="content-auto" class="sim-content h-full hidden flex flex-col items-center">
                     <div class="w-full max-w-lg bg-white rounded-xl shadow-sm p-3 mb-4 flex gap-3 border-l-4 border-green-500 relative">
                        <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=InstructorAuto" class="w-10 h-10 rounded-full bg-green-50">
                        <div class="flex-1">
                            <p class="text-xs font-bold text-green-900 mb-1">‡∏Ñ‡∏£‡∏π‡∏ù‡∏∂‡∏Å‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡∏≠‡∏≠‡πÇ‡∏ï‡πâ</p>
                            <p id="auto-instruction" class="text-sm text-gray-700 leading-tight">‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏ö <b>‡πÄ‡∏ö‡∏£‡∏Å</b> ‡∏Ñ‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡πÄ‡∏™‡∏°‡∏≠</p>
                            <div class="flex gap-2 mt-2 justify-end">
                                <button onclick="autoTutorial.prev()" class="px-3 py-1 bg-gray-100 rounded text-xs hover:bg-gray-200">‡∏¢‡πâ‡∏≠‡∏ô</button>
                                <button onclick="autoTutorial.next()" class="px-3 py-1 bg-green-600 text-white rounded text-xs hover:bg-green-700 shadow-sm">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
                            </div>
                        </div>
                    </div>

                    <div class="w-full max-w-lg flex-1 bg-gray-200 rounded-2xl p-4 relative flex flex-col items-center justify-between min-h-[400px] border-4 border-white shadow-inner">
                         <div class="w-full flex justify-between items-center bg-white p-3 rounded-xl shadow-sm mb-4">
                             <div>
                                 <div class="text-[10px] text-gray-400 uppercase font-bold">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß</div>
                                 <div class="text-2xl font-bold text-gray-800"><span id="auto-speed">0</span> <span class="text-sm font-normal text-gray-500">km/h</span></div>
                             </div>
                             <div class="text-right">
                                 <!-- Fixed Start Button for Multi-touch -->
                                 <button 
                                    ontouchstart="event.preventDefault(); toggleAutoEngine()"
                                    onclick="toggleAutoEngine()"
                                    class="sim-btn bg-red-500 hover:bg-red-600 text-white text-xs px-4 py-2 rounded-lg shadow font-bold transition">
                                     <i class="fas fa-power-off mr-1"></i> <span id="auto-status-text">START</span>
                                 </button>
                                 <div id="auto-engine-dot" class="w-2 h-2 rounded-full bg-red-300 mx-auto mt-1"></div>
                             </div>
                         </div>
                         <div class="flex-1 flex w-full gap-4 items-end justify-between px-2">
                            <div class="bg-gray-800 p-2 rounded-2xl shadow-xl">
                                <div class="flex flex-col gap-2">
                                    <!-- Added ontouchstart to all Auto gears -->
                                    <button ontouchstart="event.preventDefault(); shiftAuto('P')" onclick="shiftAuto('P')" id="auto-P" class="sim-btn w-12 h-10 rounded bg-gray-700 text-white font-bold text-sm border-l-4 border-transparent transition">P</button>
                                    <button ontouchstart="event.preventDefault(); shiftAuto('R')" onclick="shiftAuto('R')" id="auto-R" class="sim-btn w-12 h-10 rounded bg-gray-700 text-white font-bold text-sm border-l-4 border-transparent transition">R</button>
                                    <button ontouchstart="event.preventDefault(); shiftAuto('N')" onclick="shiftAuto('N')" id="auto-N" class="sim-btn w-12 h-10 rounded bg-gray-700 text-white font-bold text-sm border-l-4 border-transparent transition">N</button>
                                    <button ontouchstart="event.preventDefault(); shiftAuto('D')" onclick="shiftAuto('D')" id="auto-D" class="sim-btn w-12 h-10 rounded bg-gray-700 text-white font-bold text-sm border-l-4 border-transparent transition">D</button>
                                </div>
                            </div>
                            <div class="flex gap-4 no-select items-end">
                                <div class="flex flex-col items-center">
                                    <!-- Brake Pedal: Support simple Hold and Lock -->
                                    <div id="auto-brake" 
                                         ontouchstart="event.preventDefault(); pressAutoBrake(true)" 
                                         ontouchend="event.preventDefault(); if(!autoState.brakeLocked) pressAutoBrake(false)"
                                         onmousedown="pressAutoBrake(true)" 
                                         onmouseup="if(!autoState.brakeLocked) pressAutoBrake(false)"
                                         class="pedal w-20 h-20 bg-gray-700 rounded-lg border-b-4 border-gray-900 shadow-xl flex items-center justify-center group relative">
                                         <i class="fas fa-lock text-yellow-500 opacity-0 group-[.locked]:opacity-100 absolute top-2 transition-opacity text-xs"></i>
                                         <span class="text-gray-400 text-[10px] mt-auto mb-1">‡πÅ‡∏ï‡∏∞‡∏Ñ‡πâ‡∏≤‡∏á</span>
                                    </div>
                                    <span class="text-gray-500 font-bold mt-2 text-xs">‡πÄ‡∏ö‡∏£‡∏Å</span>
                                </div>
                                <div class="flex flex-col items-center">
                                    <div id="auto-gas" 
                                         ontouchstart="event.preventDefault(); pressAutoGas(true)" ontouchend="event.preventDefault(); pressAutoGas(false)"
                                         onmousedown="pressAutoGas(true)" onmouseup="pressAutoGas(false)"
                                         class="pedal w-12 h-32 bg-black rounded-t-lg border-b-4 border-gray-900 shadow-xl"></div>
                                    <span class="text-gray-500 font-bold mt-2 text-xs">‡∏Ñ‡∏±‡∏ô‡πÄ‡∏£‡πà‡∏á</span>
                                </div>
                            </div>
                         </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SECTION 3: EXTERNAL LINKS -->
        <div id="section-external" class="fade-in min-h-full hidden">
            <div class="p-6">
                <h2 class="text-2xl font-bold mb-4 text-gray-800 border-l-4 border-purple-500 pl-3">‡∏£‡∏ñ‡∏à‡∏≥‡∏•‡∏≠‡∏á</h2>
                <p class="text-gray-500 mb-6 text-sm">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏ñ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏±‡∏ö‡∏Ç‡∏µ‡πà</p>

                 <div class="space-y-4">
                    <!-- Card 1: Manual -->
                    <a href="https://tontakankeawpang321-glitch.github.io/carmunauel.io/carmanuel.html" target="_blank" class="external-card block bg-white rounded-2xl p-4 shadow-sm border border-gray-100 flex items-center gap-4 hover:shadow-md transition">
                        <div class="w-16 h-16 bg-blue-100 rounded-xl flex items-center justify-center text-blue-600 text-2xl shrink-0">
                            <i class="fas fa-cogs"></i>
                        </div>
                        <div class="flex-1">
                            <h3 class="font-bold text-lg text-gray-800">‡∏£‡∏ñ‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤</h3>
                            <p class="text-xs text-gray-500">‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏ö‡∏Ñ‡∏•‡∏±‡∏ï‡∏ä‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå</p>
                        </div>
                        <div class="w-8 h-8 bg-gray-50 rounded-full flex items-center justify-center text-gray-400">
                            <i class="fas fa-external-link-alt text-sm"></i>
                        </div>
                    </a>

                    <!-- Card 2: Auto -->
                    <a href="https://tontakankeawpang321-glitch.github.io/carmunauel.io/carauto.html" target="_blank" class="external-card block bg-white rounded-2xl p-4 shadow-sm border border-gray-100 flex items-center gap-4 hover:shadow-md transition">
                        <div class="w-16 h-16 bg-green-100 rounded-xl flex items-center justify-center text-green-600 text-2xl shrink-0">
                            <i class="fas fa-car"></i>
                        </div>
                        <div class="flex-1">
                            <h3 class="font-bold text-lg text-gray-800">‡∏£‡∏ñ‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡∏≠‡∏≠‡πÇ‡∏ï‡πâ</h3>
                            <p class="text-xs text-gray-500">‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏±‡∏ö‡∏Ç‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</p>
                        </div>
                        <div class="w-8 h-8 bg-gray-50 rounded-full flex items-center justify-center text-gray-400">
                            <i class="fas fa-external-link-alt text-sm"></i>
                        </div>
                    </a>

                    <!-- Card 3: Moto -->
                    <a href="https://tontakankeawpang321-glitch.github.io/carmunauel.io/motorgp.html" target="_blank" class="external-card block bg-white rounded-2xl p-4 shadow-sm border border-gray-100 flex items-center gap-4 hover:shadow-md transition">
                        <div class="w-16 h-16 bg-orange-100 rounded-xl flex items-center justify-center text-orange-600 text-2xl shrink-0">
                            <i class="fas fa-motorcycle"></i>
                        </div>
                        <div class="flex-1">
                            <h3 class="font-bold text-lg text-gray-800">‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÑ‡∏ã‡∏Ñ‡πå</h3>
                            <p class="text-xs text-gray-500">‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏£‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏•‡∏∞‡∏ö‡∏¥‡∏î‡∏Ñ‡∏±‡∏ô‡πÄ‡∏£‡πà‡∏á</p>
                        </div>
                        <div class="w-8 h-8 bg-gray-50 rounded-full flex items-center justify-center text-gray-400">
                            <i class="fas fa-external-link-alt text-sm"></i>
                        </div>
                    </a>
                </div>
            </div>
        </div>

    </main>

    <!-- Bottom Navigation Bar -->
    <nav class="bg-white border-t border-gray-200 fixed bottom-0 w-full h-16 flex justify-around items-center z-30 pb-safe px-2">
        <button onclick="switchMainTab('knowledge')" id="nav-knowledge" class="nav-item active flex flex-col items-center justify-center w-full h-full text-gray-400 hover:bg-gray-50 transition">
            <i class="fas fa-book-open text-xl mb-1 transition-transform duration-200"></i>
            <span class="text-[10px] font-medium">‡∏Ñ‡∏•‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ</span>
        </button>
        
        <button onclick="switchMainTab('sim')" id="nav-sim" class="nav-item flex flex-col items-center justify-center w-full h-full text-gray-400 hover:bg-gray-50 transition">
            <i class="fas fa-gamepad text-xl mb-1 transition-transform duration-200"></i>
            <span class="text-[10px] font-medium">‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏Ç‡∏±‡∏ö</span>
        </button>

        <button onclick="switchMainTab('external')" id="nav-external" class="nav-item flex flex-col items-center justify-center w-full h-full text-gray-400 hover:bg-gray-50 transition">
            <i class="fas fa-car text-xl mb-1 transition-transform duration-200"></i>
            <span class="text-[10px] font-medium">‡∏£‡∏ñ‡∏à‡∏≥‡∏•‡∏≠‡∏á</span>
        </button>
    </nav>

    <!-- Custom Alert Modal -->
    <div id="custom-modal" class="fixed inset-0 bg-black/60 z-50 hidden items-center justify-center backdrop-blur-sm fade-in">
        <div class="bg-white p-6 rounded-2xl shadow-2xl max-w-sm w-full mx-4 text-center transform transition-all scale-100">
            <div id="modal-icon" class="text-5xl mb-4">‚ö†Ô∏è</div>
            <h3 class="text-xl font-bold text-gray-800 mb-2">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h3>
            <p id="modal-msg" class="text-gray-600 mb-6 text-sm">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</p>
            <button onclick="closeModal()" class="bg-blue-600 text-white w-full py-3 rounded-xl font-bold hover:bg-blue-700 transition active:scale-95">‡∏ï‡∏Å‡∏•‡∏á</button>
        </div>
    </div>

    <script>
        // --- Custom Alert System ---
        function showAlert(msg) {
            let icon = 'üîî';
            let cleanMsg = msg;
            
            if(msg.includes('üí•')) { icon = 'üí•'; cleanMsg = msg.replace('üí•', ''); }
            else if(msg.includes('‚ö†Ô∏è')) { icon = '‚ö†Ô∏è'; cleanMsg = msg.replace('‚ö†Ô∏è', ''); }
            
            document.getElementById('modal-icon').innerText = icon;
            document.getElementById('modal-msg').innerHTML = cleanMsg.trim();
            
            const modal = document.getElementById('custom-modal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        function closeModal() {
            const modal = document.getElementById('custom-modal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }

        // --- Navigation Logic ---
        let currentSection = 'knowledge';
        
        function switchMainTab(sectionId) {
            currentSection = sectionId;
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active', 'text-blue-600'));
            document.getElementById('nav-' + sectionId).classList.add('active', 'text-blue-600');
            
            document.getElementById('section-knowledge').classList.add('hidden');
            document.getElementById('section-sim').classList.add('hidden');
            document.getElementById('section-external').classList.add('hidden');
            
            const target = document.getElementById('section-' + sectionId);
            target.classList.remove('hidden');
            target.classList.add('fade-in');
            setTimeout(() => target.classList.remove('fade-in'), 300);
        }

        function switchSubTab(section, tabId) {
            const container = document.getElementById('section-' + section);
            container.querySelectorAll('.sub-tab').forEach(el => el.classList.remove('active'));
            document.getElementById('tab-' + tabId).classList.add('active');

            if (section === 'knowledge') {
                container.querySelectorAll('.knowledge-content').forEach(el => el.classList.add('hidden'));
                const content = document.getElementById('content-' + tabId);
                content.classList.remove('hidden');
                content.classList.add('fade-in');
            } else if (section === 'sim') {
                container.querySelectorAll('.sim-content').forEach(el => el.classList.add('hidden'));
                const content = document.getElementById('content-' + tabId);
                content.classList.remove('hidden');
                content.classList.add('fade-in');
            }
        }

        // --- Tutorial System ---
        class Tutorial {
            constructor(data, textElementId) {
                this.steps = data;
                this.currentStep = 0;
                this.textElement = document.getElementById(textElementId);
            }
            update() {
                this.textElement.style.opacity = 0;
                setTimeout(() => {
                    this.textElement.innerHTML = this.steps[this.currentStep];
                    this.textElement.style.opacity = 1;
                }, 100);
            }
            next() {
                if (this.currentStep < this.steps.length - 1) {
                    this.currentStep++;
                    this.update();
                }
            }
            prev() {
                if (this.currentStep > 0) {
                    this.currentStep--;
                    this.update();
                }
            }
        }

        const manualTutorial = new Tutorial([
            "1. ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô: ‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡∏ß‡πà‡∏≤‡∏á (N) ‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏ö <b>‡∏Ñ‡∏•‡∏±‡∏ï‡∏ä‡πå</b> ‡∏Ñ‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° START",
            "2. ‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå: ‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏ö‡∏Ñ‡∏•‡∏±‡∏ï‡∏ä‡πå‡∏Ñ‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ ‡πÅ‡∏ï‡∏∞‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏Ç <b>1</b> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå 1",
            "3. ‡∏≠‡∏≠‡∏Å‡∏ï‡∏±‡∏ß: ‡∏Ñ‡πà‡∏≠‡∏¢‡πÜ <b>‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏Ñ‡∏•‡∏±‡∏ï‡∏ä‡πå</b> ‡∏ä‡πâ‡∏≤‡πÜ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ö <b>‡∏Å‡∏î‡∏Ñ‡∏±‡∏ô‡πÄ‡∏£‡πà‡∏á</b> ‡πÄ‡∏ö‡∏≤‡πÜ",
            "4. ‡∏£‡∏∞‡∏ß‡∏±‡∏á: ‡∏ñ‡πâ‡∏≤‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏Ñ‡∏•‡∏±‡∏ï‡∏ä‡πå‡πÄ‡∏£‡πá‡∏ß‡πÑ‡∏õ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÄ‡∏ï‡∏¥‡∏°‡∏Ñ‡∏±‡∏ô‡πÄ‡∏£‡πà‡∏á ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏∞‡∏î‡∏±‡∏ö!",
            "5. ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå: ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏ñ‡∏∂‡∏á 20 ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏ö‡∏Ñ‡∏•‡∏±‡∏ï‡∏ä‡πå ‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏±‡∏ô‡πÄ‡∏£‡πà‡∏á ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå 2"
        ], 'manual-instruction');

        const autoTutorial = new Tutorial([
            "1. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢: ‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡∏≠‡∏≠‡πÇ‡∏ï‡πâ‡∏ï‡πâ‡∏≠‡∏á <b>‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏ö‡πÄ‡∏ö‡∏£‡∏Å</b> ‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó‡∏£‡∏ñ‡πÄ‡∏™‡∏°‡∏≠",
            "2. ‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó: ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° START ‡∏Ç‡∏ì‡∏∞‡∏ó‡∏µ‡πà‡πÄ‡∏ó‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏ö‡πÄ‡∏ö‡∏£‡∏Å‡∏≠‡∏¢‡∏π‡πà",
            "3. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏≠‡∏≠‡∏Å‡∏ï‡∏±‡∏ß: ‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏ö‡πÄ‡∏ö‡∏£‡∏Å‡∏Ñ‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡∏°‡∏≤‡∏ó‡∏µ‡πà <b>D</b> (Drive)",
            "4. ‡∏≠‡∏≠‡∏Å‡∏£‡∏ñ: ‡∏Ñ‡πà‡∏≠‡∏¢‡πÜ ‡∏õ‡∏•‡πà‡∏≠‡∏¢‡πÄ‡∏ö‡∏£‡∏Å ‡∏£‡∏ñ‡∏à‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÑ‡∏´‡∏• (Creep) ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡πÄ‡∏ï‡∏¥‡∏°‡∏Ñ‡∏±‡∏ô‡πÄ‡∏£‡πà‡∏á",
            "5. ‡∏à‡∏≠‡∏î‡∏£‡∏ñ: ‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏ö‡πÄ‡∏ö‡∏£‡∏Å‡∏à‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏™‡∏ô‡∏¥‡∏ó ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡πÑ‡∏õ‡∏ó‡∏µ‡πà <b>P</b> (Park)"
        ], 'auto-instruction');

        // --- Simulator Logic: Shared & Utils ---
        function clamp(val, min, max) { return Math.min(Math.max(val, min), max); }

        // --- Manual Car Logic ---
        let manualState = { engine: false, rpm: 0, speed: 0, gear: 'N', clutch: false, gas: false, brake: false };
        
        function updateManualUI() {
            // Needles
            const rpmDeg = -120 + (manualState.rpm / 8000 * 240);
            const speedDeg = -120 + (manualState.speed / 200 * 240);
            document.getElementById('manual-rpm-needle').style.transform = `rotate(${rpmDeg}deg)`;
            document.getElementById('manual-rpm-text').innerText = (manualState.rpm / 1000).toFixed(1);
            document.getElementById('manual-speed-needle').style.transform = `rotate(${speedDeg}deg)`;
            document.getElementById('manual-speed-text').innerText = Math.floor(manualState.speed);

            const btn = document.getElementById('manual-status-text');
            if(manualState.engine) {
                btn.innerText = "STOP";
                btn.parentElement.classList.add('bg-green-600', 'border-green-800');
                btn.parentElement.classList.remove('bg-red-600', 'border-red-800');
            } else {
                btn.innerText = "START";
                btn.parentElement.classList.add('bg-red-600', 'border-red-800');
                btn.parentElement.classList.remove('bg-green-600', 'border-green-800');
            }

            document.getElementById('manual-gear-display').innerText = manualState.gear;
            document.querySelectorAll('.gear-btn').forEach(b => b.classList.remove('active'));
            if(manualState.gear !== 'N') document.getElementById('gear-'+manualState.gear).classList.add('active');

            document.getElementById('pedal-clutch').classList.toggle('pressed', manualState.clutch);
            document.getElementById('pedal-brake').classList.toggle('pressed', manualState.brake);
            document.getElementById('pedal-gas').classList.toggle('pressed', manualState.gas);
        }

        function toggleManualEngine() {
            if(manualState.engine) {
                manualState.engine = false; manualState.rpm = 0; manualState.speed = 0;
            } else {
                // Modified: Removed clutch check to allow easier start / multi-touch
                manualState.engine = true; manualState.rpm = 800;
            }
            updateManualUI();
        }

        function shiftManual(g) {
            if(!manualState.clutch && manualState.engine) {
                manualState.engine = false; manualState.rpm = 0; manualState.speed = 0;
                showAlert('üí• ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏±‡∏ö! ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏ö‡∏Ñ‡∏•‡∏±‡∏ï‡∏ä‡πå');
            } else {
                manualState.gear = (manualState.gear === g) ? 'N' : g;
            }
            updateManualUI();
        }

        function pressClutch(v) { manualState.clutch = v; updateManualUI(); }
        function pressBrake(v) { manualState.brake = v; updateManualUI(); }
        function pressGas(v) { manualState.gas = v; updateManualUI(); }

        setInterval(() => {
            if(!manualState.engine) return;
            if(manualState.gas) {
                if(manualState.clutch || manualState.gear === 'N') manualState.rpm = clamp(manualState.rpm + 200, 0, 7000);
                else {
                    manualState.rpm = clamp(manualState.rpm + 50, 0, 6000);
                    manualState.speed = clamp(manualState.speed + 1.5, 0, 180);
                }
            } else {
                manualState.rpm = clamp(manualState.rpm - 100, 800, 7000);
                manualState.speed = clamp(manualState.speed - 0.5, 0, 180);
            }
            if(manualState.brake) manualState.speed = clamp(manualState.speed - 3, 0, 180);
            if(manualState.gear !== 'N' && !manualState.clutch && manualState.rpm < 500 && manualState.speed === 0) {
                manualState.engine = false; manualState.rpm = 0;
            }
            updateManualUI();
        }, 50);

        // --- Auto Car Logic (Fixed Bug) ---
        let autoState = { engine: false, gear: 'P', speed: 0, brake: false, gas: false, brakeLocked: false };

        function updateAutoUI() {
            ['P','R','N','D'].forEach(g => {
                const el = document.getElementById('auto-'+g);
                if(autoState.gear === g) el.classList.add('bg-blue-600', 'text-white', 'border-blue-400');
                else el.classList.remove('bg-blue-600', 'text-white', 'border-blue-400');
            });

            const statusText = document.getElementById('auto-status-text');
            const statusDot = document.getElementById('auto-engine-dot');
            if(autoState.engine) {
                statusText.innerText = "STOP";
                statusDot.classList.add('bg-green-500', 'animate-pulse');
                statusDot.classList.remove('bg-red-300');
            } else {
                statusText.innerText = "START";
                statusDot.classList.remove('bg-green-500', 'animate-pulse');
                statusDot.classList.add('bg-red-300');
            }
            document.getElementById('auto-speed').innerText = Math.floor(autoState.speed);

            const brakeEl = document.getElementById('auto-brake');
            if(autoState.brake) {
                brakeEl.classList.add('pressed');
                if(autoState.brakeLocked) brakeEl.classList.add('locked');
            } else {
                brakeEl.classList.remove('pressed', 'locked');
            }
            document.getElementById('auto-gas').classList.toggle('pressed', autoState.gas);
        }

        function toggleBrakeLock() {
            autoState.brakeLocked = !autoState.brakeLocked;
            autoState.brake = autoState.brakeLocked;
            updateAutoUI();
        }

        function toggleAutoEngine() {
            if(!autoState.brake && !autoState.engine) {
                showAlert('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏ö‡πÄ‡∏ö‡∏£‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó');
                return;
            }
            // Strict P gear requirement for Auto start
            if(autoState.gear !== 'P' && !autoState.engine) {
                showAlert('‚ö†Ô∏è ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå P ‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó');
                return;
            }
            autoState.engine = !autoState.engine;
            if(!autoState.engine) autoState.speed = 0;
            updateAutoUI();
        }

        function shiftAuto(g) {
            if(!autoState.brake && autoState.engine) {
                showAlert('‚ö†Ô∏è ‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏ö‡πÄ‡∏ö‡∏£‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå‡πÄ‡∏™‡∏°‡∏≠');
                return;
            }
            autoState.gear = g;
            updateAutoUI();
        }

        function pressAutoBrake(v) { 
            if(autoState.brakeLocked && !v) return; 
            autoState.brake = v; 
            updateAutoUI(); 
        }
        function pressAutoGas(v) { autoState.gas = v; updateAutoUI(); }

        setInterval(() => {
            if(!autoState.engine) return;
            if(autoState.gear === 'D') {
                if(autoState.gas) autoState.speed += 1.2;
                else if(!autoState.brake) autoState.speed = clamp(autoState.speed + 0.1, 0, 5); 
                else autoState.speed -= 2;
            } else if (autoState.gear === 'R') {
                if(autoState.gas) autoState.speed += 0.8;
            } else if (autoState.gear === 'N' || autoState.gear === 'P') {
                autoState.speed -= 1;
            }
            if(autoState.brake) autoState.speed -= 3;
            autoState.speed = clamp(autoState.speed, 0, 160);
            updateAutoUI();
        }, 50);

        // Init
        switchMainTab('knowledge');
        switchSubTab('knowledge', 'license');

    </script>
</body>
</html>
